# audisp plugin configuration for routing Landlock V7 audit events
# to a user-readable log file for gleisner denial collection.
#
# Setup:
#   1. Copy this file to /etc/audit/plugins.d/audisp-landlock.conf
#   2. Copy audisp-landlock-filter.sh to /usr/local/bin/
#   3. Make the filter script executable: chmod +x /usr/local/bin/audisp-landlock-filter.sh
#   4. Create the log directory: mkdir -p ~/.config/gleisner
#   5. Restart auditd: systemctl restart auditd (or rc-service auditd restart)
#
# Then use: gleisner record --kernel-audit-log ~/.config/gleisner/landlock-audit.log
#
# The filter script reads audit records from stdin (piped by audisp)
# and writes only LANDLOCK_ACCESS (type 1423) records to the log file.

active = yes
direction = out
path = /usr/local/bin/audisp-landlock-filter.sh
type = always
format = string
